<h2>{% trans %}Users in domain{% endtrans %} {{ entity.name }}</h2>
{% if users|length > 0 %}{% set certActive = 'Download' %}{% set replyActive = 'Edit' %}
    <div>
    <table class="table table-bordered">
        <tbody>
            <tr>
                <th>{% trans %}User{% endtrans %}</th>
                <th>{% trans %}Full Name{% endtrans %}</th>
                <th>{% trans %}Active{% endtrans %}</th>
                <th>{% trans %}Admin{% endtrans %}</th>
                <th>{% trans %}Certificate{% endtrans %}</th>
                <th>{% trans %}Autoreply{% endtrans %}</th>
            </tr>
            {% for user in users %}{% set email = user.name ~ '@' ~ entity.name %}
            <tr>
                <td><a href="#" data-action="click->modal-loader#open"
                {% if origin is defined -%}
                    data-url="{{ path('manage_user_edit', { 'id': user.id, 'origin': origin } ) }}">{{ email }}</a></td>
                {% else -%}
                    data-url="{{ path('manage_user_edit', { 'id': user.id } ) }}">{{ email }}</a></td>
                {% endif %}
                <td>{{ user.fullName }}</td>
                <td>{{ user.isActive ? 'âˆš' : '--' }}</td>
                <td>{{ user.isAdmin ? 'âˆš' : '--' }}</td>
                <td>{% if entity.certdata -%}
                    <a href="#" data-action="click->modal-loader#open"
                        {% if user.certdata %}
                            class="btn btn-secondary" data-url="{{ path('admin_certificate_client_new', { 'id': user.id, 'new': 0 } ) }}">{% trans %}View{% endtrans %}</a>
                            <a href="#" data-action="click->modal-loader#open" class="btn btn-secondary" data-url="{{ path('admin_certificate_client_download', { 'id': user.id } ) }}">{% trans %}Download{% endtrans %}</a>
                        {% else %}
                            class="btn btn-primary"
                            data-url="{{ path('admin_certificate_client_new', { 'id': user.id } ) }}"
                            >{% trans %}Create{% endtrans %}</a>
                        {% endif %}
                    {%- else -%}
                        --</a>
                    {%- endif -%}
                </td>
                <td><a href="#" data-action="click->modal-loader#open"
                    {%- if user.reply -%}
                    {%- else -%}{% set replyActive = 'Create' %}
                    {%- endif %} data-url="{{ path('user_autoreply_edit', { 'id': user.id } ) }}"
                    class="btn btn-{{ user.reply ? 'secondary' :'primary' }}"
                    >{{ replyActive|trans }}</a>
                </td>
        </tr>
            {% endfor %}
        </tbody>
    </table>
    </div>
{% else %}
    <p>{% trans %}No users in domain{% endtrans %}</p>
{% endif %}
<a class="btn btn-primary"  data-action="modal-loader#open" href="#"
{% if is_granted('ROLE_ADMIN') %}
data-url="{{ path('manage_user_admin_new', { 'id': entity.id } )}}"
{% else %}
data-url="{{ path('manage_user_new') }}"
{% endif %}
>{{ 'Create a new user'|trans }}</a>
